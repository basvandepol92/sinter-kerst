import{j as c}from"./index-CKP4gws7.js";const w="/sinter-kerst/assets/sinterkerst-C5Qj2tnV.mp3",u=c(null),t=c(null),n=c(null),r=c(null),l=c(!1),i=async()=>(u.value||(u.value=new AudioContext,t.value=u.value.createGain(),t.value.gain.value=.15,t.value.connect(u.value.destination)),u.value.state==="suspended"&&await u.value.resume(),u.value),d=()=>{t.value&&(t.value.gain.value=l.value?0:.15)},m=async(a,s=.2,e=.12)=>{const v=await i();if(!t.value)return;const o=v.createOscillator(),f=v.createGain();o.type="square",o.frequency.value=a,f.gain.value=l.value?0:e,o.connect(f).connect(t.value);const p=v.currentTime;o.start(p),o.stop(p+s)},y=async()=>{if(r.value)return r.value;const a=await i(),e=await(await fetch(w)).arrayBuffer();return r.value=await a.decodeAudioData(e),r.value},x=async()=>{const a=await i(),s=await y();if(!s||!t.value)return;n.value&&(n.value.stop(),n.value.disconnect());const e=a.createBufferSource();e.buffer=s,e.loop=!0,e.connect(t.value),e.start(0),n.value=e,d()},g=()=>{n.value&&(n.value.stop(),n.value.disconnect(),n.value=null)},h=()=>{[0,4,7,12].forEach((s,e)=>{window.setTimeout(()=>{m(523.25*Math.pow(2,s/12),.25,.18)},e*90)})},B=()=>{m(880,.15,.1)},C=a=>{l.value=a,d()},T=()=>({isMuted:l,ensureContext:i,setMuted:C,startLoop:x,stopLoop:g,playWinChord:h,playTimerPing:B});export{T as u};
