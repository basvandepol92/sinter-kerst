import{d as z,j as k,k as E,h as J,l as R,c as a,e as d,a as t,w as o,u as q,f as D,m as f,v as w,p as P,g as n,F as G,r as Z,t as u,o as p,q as H,i as K,_ as Q}from"./index-CizmrxTt.js";import{A as W}from"./AppCard-BiM4Sfzj.js";import{A as y}from"./AppButton-CjW2r0Ix.js";import{u as X}from"./gameStore-DlP5lpfE.js";const Y={class:"page"},_={class:"toolbar"},ee={class:"filters"},te={class:"io"},se={class:"import"},le={class:"layout"},ie={class:"table-wrapper"},ne={key:0},re={key:1},oe={class:"actions"},ae=["onClick"],de=["onClick"],ue=["value"],pe={key:0,class:"error"},me={class:"form-actions"},ve=z({__name:"ChallengeManagerView",setup(fe){const m=X(),T=D(),c=k("all"),O=k(""),x={id:"",title:"",description:"",type:"individual",minPlayers:1,maxPlayers:1,timerOverrideSeconds:null},i=E({...x}),g=k(null),v=k(""),I=J(()=>m.challenges.filter(s=>{const e=c.value==="all"||s.type===c.value,l=O.value.trim().toLowerCase(),r=l===""||s.title.toLowerCase().includes(l)||s.description.toLowerCase().includes(l);return e&&r})),b=()=>{Object.assign(i,{...x,id:`custom-${Date.now()}`}),g.value=null,v.value=""};b();const N=s=>{Object.assign(i,{...s,minPlayers:s.type==="individual"?1:2,maxPlayers:s.type==="individual"?1:4}),i.timerOverrideSeconds===void 0&&(i.timerOverrideSeconds=null),g.value=s.id},L=()=>!i.id.trim()||!i.title.trim()?"Id en titel zijn verplicht.":i.description.trim()?"":"Beschrijving ontbreekt.",V=s=>s.type==="individual"?{...s,minPlayers:1,maxPlayers:1,timerOverrideSeconds:s.timerOverrideSeconds??null}:{...s,minPlayers:2,maxPlayers:4,timerOverrideSeconds:s.timerOverrideSeconds??null},h=()=>{const s=L();if(s){v.value=s;return}m.upsertChallenge(V({...i})),v.value="",b()},B=s=>{confirm("Challenge verwijderen?")&&m.deleteChallenge(s)},U=s=>!s||typeof s!="object"?!1:typeof s.id=="string"&&typeof s.title=="string"&&typeof s.description=="string"&&typeof s.type=="string"&&typeof s.minPlayers=="number"&&typeof s.maxPlayers=="number"&&(s.timerOverrideSeconds===void 0||s.timerOverrideSeconds===null||typeof s.timerOverrideSeconds=="number"),A=async s=>{var j;const e=s.target;if(!((j=e.files)!=null&&j.length))return;const r=await e.files[0].text();try{const C=JSON.parse(r);if(!Array.isArray(C)||!C.every(S=>U(S)))throw new Error("invalid");const F=C.map(S=>V(S));m.importChallenges(F)}catch{alert("JSON ongeldig")}finally{e.value=""}},M=()=>{const s=JSON.stringify(m.challenges,null,2),e=new Blob([s],{type:"application/json"}),l=URL.createObjectURL(e),r=document.createElement("a");r.href=l,r.download="sinter-kerst-challenges.json",r.click(),URL.revokeObjectURL(l)},$=s=>{const e=s.target.value;if(e===""){i.timerOverrideSeconds=null;return}const l=Number(e);i.timerOverrideSeconds=Number.isFinite(l)?Math.max(5,Math.floor(l)):null};return R(()=>i.type,s=>{s==="individual"?(i.minPlayers=1,i.maxPlayers=1):(i.minPlayers=2,i.maxPlayers=4)}),(s,e)=>(p(),a("div",Y,[d(y,{theme:"ghost",icon:"⬅️",class:"back",onClick:e[0]||(e[0]=l=>q(T).back())},{default:o(()=>[...e[10]||(e[10]=[n("Terug",-1)])]),_:1}),e[24]||(e[24]=t("h1",null,"Challenge-beheer",-1)),t("div",_,[f(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>O.value=l),type:"search",placeholder:"Zoek..."},null,512),[[w,O.value]]),t("div",ee,[f(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>c.value=l)},[...e[11]||(e[11]=[t("option",{value:"all"},"Alle types",-1),t("option",{value:"individual"},"Individual",-1),t("option",{value:"versus"},"Versus",-1)])],512),[[P,c.value]])]),t("div",te,[d(y,{size:"sm",theme:"ghost",icon:"➕",onClick:e[3]||(e[3]=l=>b())},{default:o(()=>[...e[12]||(e[12]=[n("Nieuwe challenge",-1)])]),_:1}),t("label",se,[e[13]||(e[13]=n(" Import JSON ",-1)),t("input",{type:"file",accept:"application/json",onChange:A},null,32)]),d(y,{size:"sm",theme:"ghost",onClick:e[4]||(e[4]=l=>M())},{default:o(()=>[...e[14]||(e[14]=[n("Exporteren",-1)])]),_:1})])]),t("div",le,[t("div",ie,[t("table",null,[e[15]||(e[15]=t("thead",null,[t("tr",null,[t("th",null,"Titel"),t("th",null,"Type"),t("th",null,"Timer"),t("th")])],-1)),t("tbody",null,[(p(!0),a(G,null,Z(I.value,l=>(p(),a("tr",{key:l.id},[t("td",null,u(l.title),1),t("td",null,u(l.type==="individual"?"Individual (solo)":"Versus (2-4)"),1),t("td",null,[l.timerOverrideSeconds?(p(),a("span",ne,u(l.timerOverrideSeconds)+"s",1)):(p(),a("span",re,"Standaard"))]),t("td",oe,[t("button",{onClick:r=>N(l)},"Bewerken",8,ae),t("button",{class:"danger",onClick:r=>B(l.id)},"✖",8,de)])]))),128))])])]),d(W,null,{heading:o(()=>[n(u(g.value?"Challenge bewerken":"Nieuwe challenge"),1)]),default:o(()=>[t("form",{class:"form",onSubmit:H(h,["prevent"])},[t("label",null,[e[16]||(e[16]=n(" Titel ",-1)),f(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>i.title=l),required:""},null,512),[[w,i.title]])]),t("label",null,[e[17]||(e[17]=n(" Beschrijving ",-1)),f(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>i.description=l),required:"",rows:"3"},null,512),[[w,i.description]])]),t("label",null,[e[19]||(e[19]=n(" Type ",-1)),f(t("select",{"onUpdate:modelValue":e[7]||(e[7]=l=>i.type=l)},[...e[18]||(e[18]=[t("option",{value:"individual"},"Individual",-1),t("option",{value:"versus"},"Versus",-1)])],512),[[P,i.type]])]),e[23]||(e[23]=t("p",{class:"hint"},"Individual = 1 speler · Versus = 2-4 spelers",-1)),t("label",null,[e[20]||(e[20]=n(" Timer override (optioneel, seconden) ",-1)),t("input",{type:"number",min:"5",value:i.timerOverrideSeconds??"",onInput:e[8]||(e[8]=l=>$(l)),placeholder:"Bijv. 60"},null,40,ue),e[21]||(e[21]=t("small",{class:"hint"},"Laat leeg om de timer uit Instellingen te gebruiken.",-1))]),v.value?(p(),a("p",pe,u(v.value),1)):K("",!0),t("div",me,[d(y,{type:"button",theme:"ghost",size:"sm",onClick:e[9]||(e[9]=l=>b())},{default:o(()=>[...e[22]||(e[22]=[n("Leegmaken",-1)])]),_:1}),d(y,{size:"sm",type:"submit"},{default:o(()=>[n(u(g.value?"Opslaan":"Toevoegen"),1)]),_:1})])],32)]),_:1})])]))}}),Ce=Q(ve,[["__scopeId","data-v-5c376ba8"]]);export{Ce as default};
