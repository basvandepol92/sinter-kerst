import{B as ae,j as m,k as C,l as le,h as g}from"./index-CKP4gws7.js";const se=[{id:"klok-klap",title:"Klingelende Klok",description:"Loop alsof je een bezorg-Piet bent en tik onderweg vijf decorstukken aan. De snelste wint.",type:"versus",minPlayers:2,maxPlayers:4},{id:"koek-koers",title:"Koekjes Koers",description:"Balanceer een pepernoot op een lepel. Wie het verst geraakt zonder te laten vallen wint.",type:"individual",minPlayers:1,maxPlayers:1},{id:"gift-glider",title:"Gift Glider",description:"Maak in duo een slee van aanwezige materialen en glijd 2 meter. Jury kiest de meest creatieve slee.",type:"versus",minPlayers:2,maxPlayers:4},{id:"sneeuw-mime",title:"Sneeuw Mime",description:"Doe een winteractiviteit in pantomime. De rest raadt. Degene die het snelst correct raadt scoort.",type:"individual",minPlayers:1,maxPlayers:1},{id:"lichtlijn",title:"Lichtjeslijn",description:"Leg een snoer van lichtgevende objecten zonder dat de lijn breekt. Meest rechte lijn wint.",type:"versus",minPlayers:2,maxPlayers:4},{id:"pakjespong",title:"Pakjes Pong",description:"Versus battle: kaats een zachte kerstbal over de tafel. Laat hem niet vallen! Eerste tot 5 punten wint.",type:"versus",minPlayers:2,maxPlayers:4},{id:"duo-dans",title:"Duo Dans der Rendieren",description:"Maak met zijn tweeën een korte syncro-dans op de chiptune beat. Publiek stemt.",type:"versus",minPlayers:2,maxPlayers:4},{id:"rijm-rap",title:"Rijm Rap Blitz",description:"Spit in 45 seconden een rijm over cadeaus voor iemand naar keuze. Publiek kiest de winnaar.",type:"individual",minPlayers:1,maxPlayers:1},{id:"puzzel-piet",title:"Puzzel-Piet Relay",description:"Bouw in duo een mini-kersthuisje met blokken. Wissel elke 20 seconden. Klaar? Roep “Ho-Ho!”.",type:"versus",minPlayers:2,maxPlayers:4},{id:"sok-shuffle",title:"Sokken Shuffle",description:"Versus: schuif in dikke kerstsokken over de vloer en verzamel kaartjes. Meeste kaartjes wint.",type:"versus",minPlayers:2,maxPlayers:4},{id:"mystery-melodie",title:"Mystery Melodie",description:"Fluit of neurie een feestnummer. Wie het lied als eerste herkent, scoort een punt.",type:"individual",minPlayers:1,maxPlayers:1},{id:"sneeuw-stapel",title:"Sneeuwvlok Stapel",description:"Individueel: stapel marshmallows zo hoog mogelijk binnen de tijd. Toren om? Opnieuw beginnen.",type:"individual",minPlayers:1,maxPlayers:1}],ie="/sinter-kerst/assets/Julot-Dm7o0kCE.png",re="/sinter-kerst/assets/Flo-3ytGCO-u.png",oe="/sinter-kerst/assets/Tess-D-3Y02l7.png",ue="/sinter-kerst/assets/Bas-D1xI_qpA.png",ce=[{id:"julot",name:"Julot",color:"#ff8a8a",accent:"#ffd1d1",sprite:ie,enabled:!0,score:0},{id:"flo",name:"Flo",color:"#6dd5ff",accent:"#c9f1ff",sprite:re,enabled:!0,score:0},{id:"tess",name:"Tess",color:"#ffbe3d",accent:"#ffe3a8",sprite:oe,enabled:!0,score:0},{id:"bas",name:"Bas",color:"#c98bff",accent:"#f1d9ff",sprite:ue,enabled:!0,score:0}],de={keepScore:!0,timerSeconds:75,participantsMode:"auto",forceTimerSound:!0,recentChallengeWindow:4,avoidRepeats:!0,maxAutoPlayers:4,darkMode:!1},me=0,z=i=>()=>{let a=i+=1831565813;return a=Math.imul(a^a>>>15,a|1),a^=a+Math.imul(a^a>>>7,a|61),((a^a>>>14)>>>0)/4294967296},ve=()=>ce.map(i=>({...i})),pe=()=>se.map(i=>({...i})),ke=ae("game",()=>{const i=m(ve()),a=m(pe()),y=m([]),l=C({...de});typeof document<"u"&&le(()=>l.darkMode,e=>{document.documentElement.classList.toggle("dark-mode",e)},{immediate:!0});const o=m(null),c=m([]),u=m("idle"),s=C({running:!1,remaining:l.timerSeconds,endsAt:0}),k=m(0),v=m([]),w=m(0),h=m(Date.now()%1e5);let x=z(h.value);const A=g(()=>[...i.value].sort((e,t)=>t.score-e.score||e.name.localeCompare(t.name))),f=g(()=>i.value.filter(e=>e.enabled)),p=g(()=>a.value.find(e=>e.id===o.value)??null),S=g(()=>Date.now()>=k.value),b=()=>{var e;return((e=p.value)==null?void 0:e.timerOverrideSeconds)??l.timerSeconds},R=g(()=>b()),P=()=>x(),D=e=>{const t=[...e];for(let n=t.length-1;n>0;n-=1){const r=Math.floor(P()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t},W=e=>{const t=f.value.length;if(t===0)return 0;switch(e){case"solo":return 1;case"duo":return Math.min(2,t);case"trio":return Math.min(3,t);case"all":return t;default:if(t===1)return 1;const n=Math.min(l.maxAutoPlayers,t),r=Math.floor(P()*n)+1;return Math.min(Math.max(r,1),t)}},G=e=>{if(e===0)return[];const t=f.value;return t.length<=e?t.map(n=>n.id):D(t).slice(0,e).map(n=>n.id)},B=e=>{let t=a.value.filter(n=>e>=n.minPlayers);return l.avoidRepeats&&l.recentChallengeWindow>0&&(t=t.filter(n=>!v.value.includes(n.id))),t.length===0&&(t=a.value.filter(n=>e>=n.minPlayers)),t},I=e=>{if(!(!l.avoidRepeats||l.recentChallengeWindow<=0))for(v.value.push(e);v.value.length>l.recentChallengeWindow;)v.value.shift()},T=e=>{if(!e)return;const t=v.value.indexOf(e);t!==-1&&v.value.splice(t,1)},O=(e,t)=>{const n=Math.min(e.maxPlayers,f.value.length),r=e.minPlayers;if(n<r)return null;let d=t;return d<=0&&(d=r),d=Math.min(d,n),d=Math.max(d,r),d},M=()=>{const e=f.value.length;if(!e)return o.value=null,c.value=[],null;const t=W(l.participantsMode),n=B(e);if(n.length===0)return o.value=null,c.value=[],null;const r=n[Math.floor(P()*n.length)],d=O(r,t);if(!d)return o.value=null,c.value=[],null;const te=G(d);T(o.value),o.value=r.id,I(r.id),c.value=te,s.running=!1;const ne=r.timerOverrideSeconds??l.timerSeconds;return s.remaining=ne,s.endsAt=0,u.value="ready",r},K=()=>{if((!p.value||u.value==="complete"||u.value==="timeup")&&M(),!p.value)return!1;const e=b();return s.remaining=e,s.endsAt=performance.now()+e*1e3,s.running=!0,u.value="running",!0},L=()=>S.value?(M(),k.value=Date.now()+me,u.value="ready",!0):!1,F=e=>{if(!e.length||!p.value)return;const t=e.filter(n=>c.value.includes(n));t.length&&(l.keepScore&&(i.value=i.value.map(n=>t.includes(n.id)?{...n,score:n.score+1}:n)),y.value.push({challengeId:p.value.id,playerIds:[...c.value],winnerIds:[...t],timestamp:Date.now()}),s.running=!1,s.remaining=0,s.endsAt=0,u.value="complete",w.value+=1)},H=()=>{if(!s.running)return;const e=s.endsAt-performance.now();s.remaining=Math.max(0,e/1e3),s.remaining<=0&&(s.running=!1,s.remaining=0,u.value="timeup")},J=()=>{i.value=i.value.map(e=>({...e,score:0}))},E=e=>{i.value=i.value.map(t=>t.id===e?{...t,enabled:!t.enabled}:t)},V=(e,t)=>{i.value=i.value.map(n=>n.id===e?{...n,...t}:n)},q=e=>{var t;l.timerSeconds=Math.max(10,e),!((t=p.value)!=null&&t.timerOverrideSeconds)&&!s.running&&(s.remaining=l.timerSeconds)},Y=e=>{l.participantsMode=e},_=e=>{l.maxAutoPlayers=Math.max(1,Math.min(e,i.value.length||1))},N=e=>{l.keepScore=e},Q=e=>{l.recentChallengeWindow=Math.max(0,e),v.value=v.value.slice(-l.recentChallengeWindow)},U=e=>{l.avoidRepeats=e},X=e=>{l.darkMode=e},Z=e=>{const t=a.value.findIndex(n=>n.id===e.id);t===-1?a.value=[...a.value,e]:a.value.splice(t,1,e)},$=e=>{a.value=a.value.filter(t=>t.id!==e),o.value===e&&(o.value=null,c.value=[],u.value="idle")},ee=e=>{a.value=e,o.value=null,c.value=[],v.value=[],u.value="idle"},j=e=>{h.value=e,x=z(h.value)};return{players:i,challenges:a,challengeHistory:y,settings:l,activeChallengeId:o,activePlayerIds:c,activeChallenge:p,gamePhase:u,timer:s,rerollAvailableAt:k,rerollReady:S,winnerBurst:w,scoreboard:A,seedValue:h,currentTimerLimit:R,enabledPlayers:f,rollChallenge:M,startOrResumeChallenge:K,reroll:L,markWinners:F,tickTimer:H,resetScores:J,togglePlayer:E,updatePlayer:V,setTimerSeconds:q,setParticipantsMode:Y,setMaxAutoPlayers:_,setKeepScore:N,setRecentWindow:Q,setAvoidRepeats:U,setDarkMode:X,upsertChallenge:Z,deleteChallenge:$,importChallenges:ee,randomizeSeed:()=>{j(Math.floor(Math.random()*1e6))},setSeed:j,clearHistory:()=>{y.value=[]},resetGame:()=>{o.value=null,c.value=[],s.running=!1,s.remaining=l.timerSeconds,s.endsAt=0,u.value="idle"}}});export{ke as u};
