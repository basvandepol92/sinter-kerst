import{B as ae,j as m,k as C,l as le,h as g}from"./index-DQz3PGwN.js";const ie=[{id:"klok-klap",title:"Klingelende Klok",description:"Loop alsof je een bezorg-Piet bent en tik onderweg vijf decorstukken aan. De snelste wint.",type:"versus",minPlayers:2,maxPlayers:4},{id:"koek-koers",title:"Koekjes Koers",description:"Balanceer een pepernoot op een lepel. Wie het verst geraakt zonder te laten vallen wint.",type:"individual",minPlayers:1,maxPlayers:1},{id:"gift-glider",title:"Gift Glider",description:"Maak in duo een slee van aanwezige materialen en glijd 2 meter. Jury kiest de meest creatieve slee.",type:"versus",minPlayers:2,maxPlayers:4},{id:"sneeuw-mime",title:"Sneeuw Mime",description:"Doe een winteractiviteit in pantomime. De rest raadt. Degene die het snelst correct raadt scoort.",type:"individual",minPlayers:1,maxPlayers:1},{id:"lichtlijn",title:"Lichtjeslijn",description:"Leg een snoer van lichtgevende objecten zonder dat de lijn breekt. Meest rechte lijn wint.",type:"versus",minPlayers:2,maxPlayers:4},{id:"pakjespong",title:"Pakjes Pong",description:"Versus battle: kaats een zachte kerstbal over de tafel. Laat hem niet vallen! Eerste tot 5 punten wint.",type:"versus",minPlayers:2,maxPlayers:4},{id:"duo-dans",title:"Duo Dans der Rendieren",description:"Maak met zijn tweeën een korte syncro-dans op de chiptune beat. Publiek stemt.",type:"versus",minPlayers:2,maxPlayers:4},{id:"rijm-rap",title:"Rijm Rap Blitz",description:"Spit in 45 seconden een rijm over cadeaus voor iemand naar keuze. Publiek kiest de winnaar.",type:"individual",minPlayers:1,maxPlayers:1},{id:"puzzel-piet",title:"Puzzel-Piet Relay",description:"Bouw in duo een mini-kersthuisje met blokken. Wissel elke 20 seconden. Klaar? Roep “Ho-Ho!”.",type:"versus",minPlayers:2,maxPlayers:4},{id:"sok-shuffle",title:"Sokken Shuffle",description:"Versus: schuif in dikke kerstsokken over de vloer en verzamel kaartjes. Meeste kaartjes wint.",type:"versus",minPlayers:2,maxPlayers:4},{id:"mystery-melodie",title:"Mystery Melodie",description:"Fluit of neurie een feestnummer. Wie het lied als eerste herkent, scoort een punt.",type:"individual",minPlayers:1,maxPlayers:1},{id:"sneeuw-stapel",title:"Sneeuwvlok Stapel",description:"Individueel: stapel marshmallows zo hoog mogelijk binnen de tijd. Toren om? Opnieuw beginnen.",type:"individual",minPlayers:1,maxPlayers:1}],se="/assets/Julot-Dm7o0kCE.png",re="/assets/Flo-3ytGCO-u.png",oe="/assets/Tess-D-3Y02l7.png",ue="/assets/Bas-D1xI_qpA.png",ce=[{id:"julot",name:"Julot",color:"#ff8a8a",accent:"#ffd1d1",sprite:se,enabled:!0,score:0},{id:"flo",name:"Flo",color:"#6dd5ff",accent:"#c9f1ff",sprite:re,enabled:!0,score:0},{id:"tess",name:"Tess",color:"#ffbe3d",accent:"#ffe3a8",sprite:oe,enabled:!0,score:0},{id:"bas",name:"Bas",color:"#c98bff",accent:"#f1d9ff",sprite:ue,enabled:!0,score:0}],de={keepScore:!0,timerSeconds:75,participantsMode:"auto",forceTimerSound:!0,recentChallengeWindow:4,avoidRepeats:!0,maxAutoPlayers:4,darkMode:!1},me=0,z=s=>()=>{let a=s+=1831565813;return a=Math.imul(a^a>>>15,a|1),a^=a+Math.imul(a^a>>>7,a|61),((a^a>>>14)>>>0)/4294967296},ve=()=>ce.map(s=>({...s})),pe=()=>ie.map(s=>({...s})),ke=ae("game",()=>{const s=m(ve()),a=m(pe()),y=m([]),l=C({...de});typeof document<"u"&&le(()=>l.darkMode,e=>{document.documentElement.classList.toggle("dark-mode",e)},{immediate:!0});const o=m(null),c=m([]),u=m("idle"),i=C({running:!1,remaining:l.timerSeconds,endsAt:0}),k=m(0),v=m([]),w=m(0),h=m(Date.now()%1e5);let x=z(h.value);const A=g(()=>[...s.value].sort((e,n)=>n.score-e.score||e.name.localeCompare(n.name))),f=g(()=>s.value.filter(e=>e.enabled)),p=g(()=>a.value.find(e=>e.id===o.value)??null),S=g(()=>Date.now()>=k.value),b=()=>{var e;return((e=p.value)==null?void 0:e.timerOverrideSeconds)??l.timerSeconds},R=g(()=>b()),P=()=>x(),D=e=>{const n=[...e];for(let t=n.length-1;t>0;t-=1){const r=Math.floor(P()*(t+1));[n[t],n[r]]=[n[r],n[t]]}return n},W=e=>{const n=f.value.length;if(n===0)return 0;switch(e){case"solo":return 1;case"duo":return Math.min(2,n);case"trio":return Math.min(3,n);case"all":return n;default:if(n===1)return 1;const t=Math.min(l.maxAutoPlayers,n),r=Math.floor(P()*t)+1;return Math.min(Math.max(r,1),n)}},G=e=>{if(e===0)return[];const n=f.value;return n.length<=e?n.map(t=>t.id):D(n).slice(0,e).map(t=>t.id)},B=e=>{let n=a.value.filter(t=>e>=t.minPlayers);return l.avoidRepeats&&l.recentChallengeWindow>0&&(n=n.filter(t=>!v.value.includes(t.id))),n.length===0&&(n=a.value.filter(t=>e>=t.minPlayers)),n},I=e=>{if(!(!l.avoidRepeats||l.recentChallengeWindow<=0))for(v.value.push(e);v.value.length>l.recentChallengeWindow;)v.value.shift()},T=e=>{if(!e)return;const n=v.value.indexOf(e);n!==-1&&v.value.splice(n,1)},O=(e,n)=>{const t=Math.min(e.maxPlayers,f.value.length),r=e.minPlayers;if(t<r)return null;let d=n;return d<=0&&(d=r),d=Math.min(d,t),d=Math.max(d,r),d},M=()=>{const e=f.value.length;if(!e)return o.value=null,c.value=[],null;const n=W(l.participantsMode),t=B(e);if(t.length===0)return o.value=null,c.value=[],null;const r=t[Math.floor(P()*t.length)],d=O(r,n);if(!d)return o.value=null,c.value=[],null;const ne=G(d);T(o.value),o.value=r.id,I(r.id),c.value=ne,i.running=!1;const te=r.timerOverrideSeconds??l.timerSeconds;return i.remaining=te,i.endsAt=0,u.value="ready",r},K=()=>{if((!p.value||u.value==="complete"||u.value==="timeup")&&M(),!p.value)return!1;const e=b();return i.remaining=e,i.endsAt=performance.now()+e*1e3,i.running=!0,u.value="running",!0},L=()=>S.value?(M(),k.value=Date.now()+me,u.value="ready",!0):!1,F=e=>{if(!e.length||!p.value)return;const n=e.filter(t=>c.value.includes(t));n.length&&(l.keepScore&&(s.value=s.value.map(t=>n.includes(t.id)?{...t,score:t.score+1}:t)),y.value.push({challengeId:p.value.id,playerIds:[...c.value],winnerIds:[...n],timestamp:Date.now()}),i.running=!1,i.remaining=0,i.endsAt=0,u.value="complete",w.value+=1)},H=()=>{if(!i.running)return;const e=i.endsAt-performance.now();i.remaining=Math.max(0,e/1e3),i.remaining<=0&&(i.running=!1,i.remaining=0,u.value="timeup")},J=()=>{s.value=s.value.map(e=>({...e,score:0}))},E=e=>{s.value=s.value.map(n=>n.id===e?{...n,enabled:!n.enabled}:n)},V=(e,n)=>{s.value=s.value.map(t=>t.id===e?{...t,...n}:t)},q=e=>{var n;l.timerSeconds=Math.max(10,e),!((n=p.value)!=null&&n.timerOverrideSeconds)&&!i.running&&(i.remaining=l.timerSeconds)},Y=e=>{l.participantsMode=e},_=e=>{l.maxAutoPlayers=Math.max(1,Math.min(e,s.value.length||1))},N=e=>{l.keepScore=e},Q=e=>{l.recentChallengeWindow=Math.max(0,e),v.value=v.value.slice(-l.recentChallengeWindow)},U=e=>{l.avoidRepeats=e},X=e=>{l.darkMode=e},Z=e=>{const n=a.value.findIndex(t=>t.id===e.id);n===-1?a.value=[...a.value,e]:a.value.splice(n,1,e)},$=e=>{a.value=a.value.filter(n=>n.id!==e),o.value===e&&(o.value=null,c.value=[],u.value="idle")},ee=e=>{a.value=e,o.value=null,c.value=[],v.value=[],u.value="idle"},j=e=>{h.value=e,x=z(h.value)};return{players:s,challenges:a,challengeHistory:y,settings:l,activeChallengeId:o,activePlayerIds:c,activeChallenge:p,gamePhase:u,timer:i,rerollAvailableAt:k,rerollReady:S,winnerBurst:w,scoreboard:A,seedValue:h,currentTimerLimit:R,enabledPlayers:f,rollChallenge:M,startOrResumeChallenge:K,reroll:L,markWinners:F,tickTimer:H,resetScores:J,togglePlayer:E,updatePlayer:V,setTimerSeconds:q,setParticipantsMode:Y,setMaxAutoPlayers:_,setKeepScore:N,setRecentWindow:Q,setAvoidRepeats:U,setDarkMode:X,upsertChallenge:Z,deleteChallenge:$,importChallenges:ee,randomizeSeed:()=>{j(Math.floor(Math.random()*1e6))},setSeed:j,clearHistory:()=>{y.value=[]},resetGame:()=>{o.value=null,c.value=[],i.running=!1,i.remaining=l.timerSeconds,i.endsAt=0,u.value="idle"}}});export{ke as u};
